---
title: '**Advanced Macroeconometrics -- Assignment 2**'
author: 
  - "Elisabeth Fidrmuc"
  - "Miriam Frauenlob"
  - "Tim Koenders"
date: "May, 2023"
output: 
  pdf_document: 
    toc: yes
    keep_tex: yes
header-includes: \usepackage{tcolorbox}
papersize: a4
geometry: margin = 2cm
urlcolor: Mahogany
---

```{r global_options1, include=TRUE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig_path='figures/',echo=TRUE, warning=FALSE, message=FALSE)

set.seed(123)

```

Question 1.

```{r global_options2, include=TRUE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig_path='figures/',echo=TRUE, warning=FALSE, message=FALSE)


# Define parameters
mu <- 5
sigma <- 9
n <- 100

# Generate data
x <- rnorm(n, mean = mu, sd = sigma)

# Compute estimates of the mean with the first 1, ..., n draws
estimates <- cumsum(x) / seq_along(x)

# Plot estimates
plot(estimates, type = "l", col = "blue", xlab = "Sample size", ylab = "Estimate of the mean")

# Add true mean as a horizontal line
abline(h = mu, col = "red")


```

The plot shows that as the sample size increases, the estimates of the mean become more accurate and converge to the true mean. At the beginning, the estimates may deviate substantially from the true mean, but as the sample size grows, the estimates become more stable and approach the true mean.


```{r global_options3, include=TRUE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig_path='figures/',echo=TRUE, warning=FALSE, message=FALSE)

# Define parameters
mu <- 0
sigma <- 1
n <- 1000

# Generate two random samples from a standard normal distribution
x <- rnorm(n, mean = mu, sd = sigma)
y <- rnorm(n, mean = mu, sd = sigma)

# Convert the standard normal samples to a Cauchy distribution with scale one
z <- x / y

# Compute estimates of the mean with the first 1, ..., n draws
estimates <- cumsum(z) / seq_along(z)

# Plot estimates
plot(estimates, type = "l", col = "blue", xlab = "Sample size", ylab = "Estimate of the mean")

# Add true mean as a horizontal line
abline(h = mu, col = "red")

```

The Cauchy distribution does not have a well-defined mean and variance, as its probability density function has "heavy tails" that extend to infinity in both directions. This means that the distribution does not converge to a particular value as the sample size increases.


Question 3

```{r global_options4, include=TRUE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig_path='figures/',echo=TRUE, warning=FALSE, message=FALSE)

# Creating function
sim_linear_model <- function(n, k, alpha, beta, sigma) {
  X <- matrix(rnorm(n * k, mean = 0, sd = 1), n, k)
  x <- X[,1]
  epsilon <- rnorm(n, mean = 0, sd = sigma)
  y <- alpha + X %*% beta + epsilon
  return(list(x = x, y = y))
  
}

# Create scatterplot with regression line
sim_data <- sim_linear_model(n = 100, k = 1, alpha = 2, beta = 3, sigma = 1)
plot(sim_data$x, sim_data$y, xlab = "x", ylab = "y")
abline(lm(y ~ x, data = sim_data), col = "red")

# Define numbers of simulations

n_sims <- 1000

# Create an empty vector to store the estimated slope coefficients
beta_lse <- numeric(n_sims)

# Loop through the simulations
for (i in 1:n_sims) {
  # Simulate the data
  sim_data <- sim_linear_model(n = 100, k = 1, alpha = 2, beta = 3, sigma = 1)
  
  # Estimate the slope coefficient using linear regression
  fit <- lm(sim_data$y ~ sim_data$x)
  beta_lse[i] <- coef(fit)[2]
}

# Creating histogram
hist(beta_lse, main = "Histogram of Beta Estimates", xlab = "Beta Estimate")



```
The approximately normal distribution of the beta_lse estimates and its central tendency around the true value of the slope coefficient of 3 suggests that the beta estimate is consistent. . This means that as the number of simulations approaches infinity, the estimates produced by the estimator will converge to the true population value of the slope coefficient, and the distribution of estimates will become increasingly concentrated around the true value.


